<!DOCTYPE html>
<html lang="en">

<!-- =====================================================
     HEAD
     Page metadata + all styling
===================================================== -->
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TRTRSLF</title>

<style>
/* =====================================================
   GLOBAL PAGE STYLES
===================================================== */
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#f4efe6;
  font-family:Georgia, "Times New Roman", serif;
  color:#2b2b2b;
}

/* =====================================================
   GAME CONTAINER
===================================================== */
#game{
  width:800px;
  max-width:95%;
  background:#fffaf0;
  padding:48px 40px 36px;
  border:1px solid #d8cdb8;
  box-shadow:0 18px 40px rgba(0,0,0,.15);
  text-align:center;
}

/* =====================================================
   TITLE + SUBTITLE
===================================================== */
h1{
  letter-spacing:.3em;
  margin:0;
}

.subtitle{
  font-style:italic;
  color:#6b6458;
  margin-bottom:24px;
}

/* =====================================================
   PUZZLE DISPLAY
===================================================== */
#cipher{
  font-size:48px;
  letter-spacing:.14em;
  margin:20px 0 8px;
  font-weight:700;
}

#clue{
  font-style:italic;
  color:#6b6458;
  margin-bottom:14px;
}

/* =====================================================
   ANSWER INPUT
===================================================== */
input{
  width:100%;
  font-size:28px;
  padding:10px;
  border:none;
  border-bottom:3px solid #b9b09c;
  background:transparent;
  text-align:center;
  outline:none;
}

/* =====================================================
   BUTTON CONTROLS
===================================================== */
.controls{
  margin-top:20px;
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
}

button{
  padding:10px 16px;
  font-size:18px;
  background:#efe6d3;
  border:1px solid #b9b09c;
  cursor:pointer;
}

/* =====================================================
   FEEDBACK TEXT
===================================================== */
#feedback{
  margin-top:14px;
  min-height:24px;
  font-style:italic;
  color:#2f5f3a;
}

/* =====================================================
   FOOTER / VERSION
===================================================== */
.footer{
  margin-top:30px;
  font-size:14px;
  color:#7a7367;
}
</style>
</head>

<body>

<!-- =====================================================
     GAME UI MARKUP
===================================================== -->
<div id="game">

  <!-- ---------- TITLE ---------- -->
  <h1>TRTRSLF</h1>
  <div class="subtitle">Translate the Self</div>

  <!-- ---------- PUZZLE TEXT ---------- -->
  <div id="cipher">—</div>
  <div id="clue"></div>

  <!-- ---------- USER INPUT ---------- -->
  <input id="answer" placeholder="Type your translation…" autocomplete="off">

  <!-- ---------- BUTTONS ---------- -->
  <div class="controls">
    <button id="submitBtn">Submit</button>
    <button id="vowelsBtn">Show Vowels</button>
    <button id="revealBtn">Reveal</button>
    <button id="nextBtn">Next</button>
  </div>

  <!-- ---------- FEEDBACK ---------- -->
  <div id="feedback"></div>

  <!-- ---------- FOOTER ---------- -->
  <div class="footer">v2.10 — Stable Interface Lock</div>

</div>

<!-- =====================================================
     SCRIPT
     (All logic lives here — do not move casually)
===================================================== -->
<script>

/* =====================================================
   STATE
===================================================== */
let puzzle = null;

/* =====================================================
   LOAD PUZZLE FROM API
===================================================== */
function loadPuzzle(){
  fetch("https://trtrslf-api.vercel.app/api/puzzle")
    .then(r => r.json())
    .then(data => {
      puzzle = data;
      document.getElementById("cipher").textContent = data.noVowels;
      document.getElementById("clue").textContent = data.meta?.clue || "";
      document.getElementById("answer").value = "";
      document.getElementById("feedback").textContent = "";
    })
    .catch(() => {
      document.getElementById("cipher").textContent = "—";
      document.getElementById("feedback").textContent = "Puzzle failed to load.";
    });
}

/* =====================================================
   SUBMIT ANSWER
===================================================== */
document.getElementById("submitBtn").onclick = () => {
  if(!puzzle) return;
  const guess = document.getElementById("answer").value.trim().toUpperCase();
  document.getElementById("feedback").textContent =
    guess === puzzle.phrase
      ? puzzle.meta?.learn || "Correct."
      : puzzle.meta?.nudge || "Try again.";
};

/* =====================================================
   HINT / REVEAL CONTROLS
===================================================== */
document.getElementById("vowelsBtn").onclick = () => {
  if(puzzle) document.getElementById("cipher").textContent = puzzle.phrase;
};

document.getElementById("revealBtn").onclick = () => {
  if(puzzle) document.getElementById("cipher").textContent = puzzle.phrase;
};

/* =====================================================
   NEXT PUZZLE
===================================================== */
document.getElementById("nextBtn").onclick = loadPuzzle;

/* =====================================================
   INITIAL LOAD
===================================================== */
loadPuzzle();

</script>

</body>
</html>
