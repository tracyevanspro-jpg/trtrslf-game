<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>TRTRSLF — Translate the Self</title>

<style>
body {
  background: #f6f1e7;
  font-family: Georgia, serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

.frame {
  border: 1px solid #c9c2b8;
  padding: 60px 80px;
  text-align: center;
  width: 70%;
}

h1 {
  letter-spacing: 0.4em;
  font-size: 28px;
  margin-bottom: 8px;
}

h2 {
  font-style: italic;
  font-weight: normal;
  color: #555;
  margin-top: 0;
}

#cipher {
  margin: 40px 0;
  font-size: 26px;
  letter-spacing: 0.3em;
}

.controls button {
  margin: 8px;
  padding: 8px 16px;
  background: none;
  border: 1px solid #888;
  cursor: pointer;
  font-family: inherit;
}

.controls button:hover {
  background: #e8e2d6;
}

#meta {
  margin-top: 20px;
  font-size: 14px;
  color: #666;
}
</style>
</head>

<body>

<div class="frame">
  <h1>TRTRSLF</h1>
  <h2>Translate the Self</h2>

  <div class="controls">
    <button onclick="setCategory('biblical')">Biblical</button>
    <button onclick="setCategory('movies')">Movies</button>
    <button onclick="setCategory('songs')">Songs</button>
    <button onclick="setCategory('pop')">Pop</button>
  </div>

  <div id="cipher">Loading…</div>

  <div class="controls">
    <button onclick="reveal()">Reveal</button>
    <button onclick="nextPuzzle()">Next</button>
  </div>

  <div class="controls">
    <button onclick="showSpaces()">Show Spaces</button>
    <button onclick="showVowels()">Show Vowels</button>
  </div>

  <div id="meta"></div>
</div>

<script>
let currentPuzzle = null;
let revealed = false;
let category = "biblical";

function setCategory(cat) {
  category = cat;
  nextPuzzle();
}

function fetchPuzzle() {
  fetch(`https://trtrslf-api.vercel.app/api/puzzle?category=${category}`)
    .then(r => r.json())
    .then(data => {
      currentPuzzle = data;
      revealed = false;
      document.getElementById("cipher").textContent = data.noVowels;
      document.getElementById("meta").textContent = "";
    })
    .catch(() => {
      document.getElementById("cipher").textContent = "Error loading puzzle";
    });
}

function reveal() {
  if (!currentPuzzle || revealed) return;
  document.getElementById("cipher").textContent = currentPuzzle.phrase;
  document.getElementById("meta").textContent =
    `${currentPuzzle.source} — ${currentPuzzle.category}`;
  revealed = true;
}

function nextPuzzle() {
  fetchPuzzle();
}

function showSpaces() {
  if (!currentPuzzle) return;
  document.getElementById("cipher").textContent = currentPuzzle.noSpaces;
}

function showVowels() {
  if (!currentPuzzle) return;
  document.getElementById("cipher").textContent = currentPuzzle.withVowels;
}

fetchPuzzle();
</script>

</body>
</html>
