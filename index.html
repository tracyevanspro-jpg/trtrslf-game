<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>TRTRSLF</title>

<style>
:root{
  --paper:#fbf6ec; --ink:#2b2b2b; --ink2:#6b6458;
  --rule:#b9b09c; --btn:#efe6d3; --btn2:#d6ccb7;
}
*{box-sizing:border-box}
body{
  margin:0; min-height:100vh; display:flex; justify-content:center; align-items:center;
  background:#f4efe6; font-family:Georgia,serif; color:var(--ink);
}
#game{
  width:min(900px,100%); padding:50px; border:1px solid var(--rule);
  background:var(--paper); text-align:center;
}
h1{letter-spacing:.35em; margin:0}
.subtitle{font-style:italic; color:var(--ink2); margin-bottom:20px}
#cipher{
  font-size:48px; letter-spacing:.15em; font-weight:700; margin:20px 0;
}
#clue{font-style:italic; color:var(--ink2); min-height:24px}
input{
  width:100%; font-size:26px; text-align:center;
  border:none; border-bottom:3px solid var(--rule);
  background:transparent; outline:none; margin-top:20px;
}
.controls{margin-top:24px; display:flex; gap:12px; flex-wrap:wrap; justify-content:center}
button{
  padding:10px 16px; font-size:18px;
  background:var(--btn); border:1px solid var(--rule); cursor:pointer;
}
button.active{background:var(--btn2)}
#feedback{
  margin-top:14px; min-height:24px; font-style:italic; color:var(--ink2)
}
.footer{margin-top:26px; font-style:italic; color:var(--ink2)}
.version{margin-top:8px; font-size:13px; opacity:.6}
select{font-size:16px; padding:6px}
</style>
</head>

<body>
<div id="game">
  <h1>TRTRSLF</h1>
  <div class="subtitle">Translate the Self</div>

  <select id="category">
    <option value="all">All categories</option>
    <option value="biblical">Biblical</option>
    <option value="movies">Movies</option>
    <option value="pop">Pop Culture</option>
    <option value="songs">Songs</option>
  </select>

  <div id="cipher">—</div>
  <div id="clue"></div>

  <input id="answer" placeholder="Type your translation…" autocomplete="off"/>

  <div id="feedback"></div>

  <div class="controls">
    <button id="submit">Submit</button>
    <button id="spaces">HINT — Show Spaces</button>
    <button id="vowels">HINT — Show Vowels</button>
    <button id="reveal">Reveal</button>
    <button id="next">Next</button>
  </div>

  <div class="footer">A small game about consonants, context, and interpretation.</div>
  <div class="version">v2.02</div>
</div>

<script>
let puzzle = null;
let revealed = false;

const cipherEl = document.getElementById("cipher");
const clueEl = document.getElementById("clue");
const feedbackEl = document.getElementById("feedback");
const answerEl = document.getElementById("answer");

function loadPuzzle(){
  fetch("https://trtrslf-api.vercel.app/api/puzzle")
    .then(r=>r.json())
    .then(data=>{
      puzzle = data;
      revealed = false;
      cipherEl.textContent = data.noVowels;
      clueEl.textContent = data.meta?.clue || "";
      feedbackEl.textContent = "";
      answerEl.value = "";
    })
    .catch(()=>{
      cipherEl.textContent = "Error loading puzzle";
    });
}

document.getElementById("submit").onclick = ()=>{
  if(!puzzle) return;
  const guess = answerEl.value.trim().toUpperCase();
  if(guess === puzzle.phrase){
    feedbackEl.textContent = puzzle.meta?.learn || "Correct.";
  } else {
    feedbackEl.textContent = puzzle.meta?.nudge || "Try again.";
  }
};

document.getElementById("spaces").onclick = ()=>{
  if(puzzle) cipherEl.textContent = puzzle.noSpaces;
};

document.getElementById("vowels").onclick = ()=>{
  if(puzzle) cipherEl.textContent = puzzle.phrase.replace(/[^AEIOU ]/gi,"_");
};

document.getElementById("reveal").onclick = ()=>{
  if(puzzle){
    cipherEl.textContent = puzzle.phrase;
    feedbackEl.textContent = puzzle.meta?.learn || "";
  }
};

document.getElementById("next").onclick = loadPuzzle;

loadPuzzle();
</script>
</body>
</html>
