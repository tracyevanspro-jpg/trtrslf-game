<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>TRTRSLF — Translate the Self</title>

<style>
body {
  background: #f6f1e7;
  font-family: Georgia, serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

.frame {
  border: 1px solid #c9c2b8;
  padding: 60px 80px;
  text-align: center;
  width: 70%;
}

h1 {
  letter-spacing: 0.4em;
  font-size: 28px;
  margin-bottom: 8px;
}

h2 {
  font-style: italic;
  font-weight: normal;
  color: #555;
  margin-top: 0;
}

#cipher {
  margin: 40px 0 10px;
  font-size: 26px;
  letter-spacing: 0.3em;
}

input {
  width: 60%;
  padding: 10px;
  font-size: 16px;
  font-family: inherit;
  border: none;
  border-bottom: 2px solid #aaa;
  background: transparent;
  text-align: center;
}

select {
  margin-top: 20px;
  font-family: inherit;
  padding: 6px;
}

.controls {
  margin-top: 30px;
}

button {
  margin: 6px;
  padding: 8px 16px;
  background: none;
  border: 1px solid #888;
  cursor: pointer;
  font-family: inherit;
}

button:hover {
  background: #e8e2d6;
}

#feedback {
  margin-top: 16px;
  font-size: 14px;
  color: #444;
}

.footer {
  margin-top: 30px;
  font-style: italic;
  color: #666;
}
</style>
</head>

<body>

<div class="frame">
  <h1>TRTRSLF</h1>
  <h2>Translate the Self</h2>

  <!-- CATEGORY DROPDOWN -->
  <select id="category" onchange="loadPuzzle()">
    <option value="">All categories</option>
    <option value="biblical">Biblical</option>
    <option value="movies">Movies</option>
    <option value="songs">Songs</option>
    <option value="pop">Pop Culture</option>
  </select>

  <div id="cipher">—</div>

  <input
    id="answer"
    placeholder="Type your translation…"
    autocomplete="off"
  />

  <div class="controls">
    <button onclick="checkAnswer()">Submit</button>
    <button onclick="showSpaces()">HINT — Show Spaces</button>
    <button onclick="showVowels()">HINT — Show Vowels</button>
    <button onclick="nextPuzzle()">Next</button>
  </div>

  <div id="feedback"></div>

  <div class="footer">
    A small game about consonants, context, and interpretation.
  </div>
</div>

<script>
let puzzle = null;

function loadPuzzle() {
  const category = document.getElementById("category").value;
  const url = category
    ? `https://trtrslf-api.vercel.app/api/puzzle?category=${category}`
    : `https://trtrslf-api.vercel.app/api/puzzle`;

  fetch(url)
    .then(r => r.json())
    .then(data => {
      puzzle = data;
      document.getElementById("cipher").textContent = data.noVowels;
      document.getElementById("answer").value = "";
      document.getElementById("feedback").textContent = "";
    })
    .catch(() => {
      document.getElementById("cipher").textContent = "Error loading puzzle";
    });
}

function checkAnswer() {
  const guess = document.getElementById("answer").value.trim().toLowerCase();
  const solution = puzzle.phrase.toLowerCase();

  document.getElementById("feedback").textContent =
    guess === solution
      ? "✔ Correct."
      : "✖ Not quite.";
}

function showSpaces() {
  document.getElementById("cipher").textContent = puzzle.noSpaces;
}

function showVowels() {
  document.getElementById("cipher").textContent = puzzle.phrase;
}

function nextPuzzle() {
  loadPuzzle();
}

document.getElementById("answer").addEventListener("keydown", e => {
  if (e.key === "Enter") checkAnswer();
});

loadPuzzle();
</script>

</body>
</html>
